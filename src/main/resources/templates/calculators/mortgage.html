<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" th:replace="~{layout/base :: layout(~{::content})}">

<div th:fragment="content">
    <header class="text-center mb-8 lg:mb-12 pb-6 border-b border-gray-200">
        <h1 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-text-primary mb-3 lg:mb-4 px-4">Mortgage Calculator</h1>
        <p class="text-base lg:text-lg text-text-secondary max-w-2xl mx-auto px-4">Calculate your monthly mortgage payments, total interest, and view detailed amortization schedules.</p>
    </header>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-8 mb-8">
        <!-- Calculator Form -->
        <div class="bg-white/50 p-4 sm:p-6 rounded-xl border border-gray-200 order-2 lg:order-1">
            <h2 class="text-lg font-semibold text-text-primary mb-4 lg:mb-6">Loan Details</h2>
            <form id="mortgage-form" class="space-y-4 lg:space-y-6">
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div>
                        <label for="loan-amount" class="block text-sm font-semibold text-text-primary mb-2">Loan Amount</label>
                        <div class="relative">
                            <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-text-muted text-sm font-medium pointer-events-none">$</span>
                            <input type="number" id="loan-amount" name="loanAmount"
                                   class="w-full pl-8 pr-4 py-2.5 lg:py-3 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors"
                                   value="300000" min="1000" max="10000000" step="1000" required>
                        </div>
                    </div>

                    <div>
                        <label for="interest-rate" class="block text-sm font-semibold text-text-primary mb-2">Interest Rate</label>
                        <div class="relative">
                            <input type="number" id="interest-rate" name="interestRate"
                                   class="w-full px-4 py-2.5 lg:py-3 pr-8 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors"
                                   value="6.5" min="0.1" max="30" step="0.01" required>
                            <span class="absolute right-3 top-1/2 transform -translate-y-1/2 text-text-muted text-sm font-medium pointer-events-none">%</span>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div>
                        <label for="loan-term" class="block text-sm font-semibold text-text-primary mb-2">Loan Term</label>
                        <select id="loan-term" name="loanTerm"
                                class="w-full px-4 py-2.5 lg:py-3 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors">
                            <option value="15">15 years</option>
                            <option value="20">20 years</option>
                            <option value="25">25 years</option>
                            <option value="30" selected>30 years</option>
                        </select>
                    </div>

                    <div>
                        <label for="down-payment" class="block text-sm font-semibold text-text-primary mb-2">Down Payment</label>
                        <div class="relative">
                            <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-text-muted text-sm font-medium pointer-events-none">$</span>
                            <input type="number" id="down-payment" name="downPayment"
                                   class="w-full pl-8 pr-4 py-2.5 lg:py-3 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors"
                                   value="60000" min="0" step="1000">
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div>
                        <label for="property-tax" class="block text-sm font-semibold text-text-primary mb-2">Annual Property Tax</label>
                        <div class="relative">
                            <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-text-muted text-sm font-medium pointer-events-none">$</span>
                            <input type="number" id="property-tax" name="propertyTax"
                                   class="w-full pl-8 pr-4 py-2.5 lg:py-3 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors"
                                   value="3600" min="0" step="100">
                        </div>
                    </div>

                    <div>
                        <label for="home-insurance" class="block text-sm font-semibold text-text-primary mb-2">Annual Home Insurance</label>
                        <div class="relative">
                            <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-text-muted text-sm font-medium pointer-events-none">$</span>
                            <input type="number" id="home-insurance" name="homeInsurance"
                                   class="w-full pl-8 pr-4 py-2.5 lg:py-3 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors"
                                   value="1200" min="0" step="100">
                        </div>
                    </div>
                </div>

                <div>
                    <label class="flex items-center gap-3 text-sm font-semibold text-text-primary">
                        <input type="checkbox" id="pmi" name="pmi" checked
                               class="w-4 h-4 text-primary-500 border-gray-300 rounded focus:ring-primary-500 focus:ring-2">
                        Include PMI (Private Mortgage Insurance)
                    </label>
                    <small class="block mt-1 text-xs text-text-secondary">Usually required when down payment is less than 20%</small>
                </div>

                <button type="submit" class="w-full px-6 py-3 bg-primary-500 text-white font-semibold rounded-lg transition-all duration-200 hover:bg-primary-600 hover:-translate-y-0.5 hover:shadow-md">
                    Calculate Payment
                </button>
            </form>
        </div>

        <!-- Results -->
        <div class="bg-white/50 p-4 sm:p-6 rounded-xl border border-gray-200 order-1 lg:order-2">
            <h2 class="text-lg font-semibold text-text-primary mb-4 lg:mb-6">Payment Summary</h2>
            <div id="mortgage-results" class="space-y-4 lg:space-y-6">
                <div>
                    <h3 class="text-base font-semibold text-text-primary mb-3 pb-2 border-b-2 border-primary-500">Monthly Payment Breakdown</h3>
                    <div class="space-y-2 lg:space-y-3">
                        <div class="flex justify-between items-center p-2.5 lg:p-3 bg-gray-100 rounded-lg border border-gray-200">
                            <span class="text-xs lg:text-sm font-medium text-text-secondary">Principal & Interest</span>
                            <span class="text-xs lg:text-sm font-semibold text-text-primary" id="principal-interest">$1,798</span>
                        </div>
                        <div class="flex justify-between items-center p-2.5 lg:p-3 bg-gray-100 rounded-lg border border-gray-200">
                            <span class="text-xs lg:text-sm font-medium text-text-secondary">Property Tax</span>
                            <span class="text-xs lg:text-sm font-semibold text-text-primary" id="monthly-tax">$300</span>
                        </div>
                        <div class="flex justify-between items-center p-2.5 lg:p-3 bg-gray-100 rounded-lg border border-gray-200">
                            <span class="text-xs lg:text-sm font-medium text-text-secondary">Home Insurance</span>
                            <span class="text-xs lg:text-sm font-semibold text-text-primary" id="monthly-insurance">$100</span>
                        </div>
                        <div class="flex justify-between items-center p-2.5 lg:p-3 bg-gray-100 rounded-lg border border-gray-200">
                            <span class="text-xs lg:text-sm font-medium text-text-secondary">PMI</span>
                            <span class="text-xs lg:text-sm font-semibold text-text-primary" id="monthly-pmi">$150</span>
                        </div>
                        <div class="flex justify-between items-center p-2.5 lg:p-3 bg-primary-50 rounded-lg border border-primary-500">
                            <span class="text-xs lg:text-sm font-semibold text-text-primary">Total Monthly Payment</span>
                            <span class="text-sm lg:text-base font-bold text-primary-500" id="total-payment">$2,348</span>
                        </div>
                    </div>
                </div>

                <div>
                    <h3 class="text-base font-semibold text-text-primary mb-3">Loan Summary</h3>
                    <div class="space-y-2 lg:space-y-3">
                        <div class="flex justify-between items-center p-2.5 lg:p-3 bg-gray-100 rounded-lg border border-gray-200">
                            <span class="text-xs lg:text-sm font-medium text-text-secondary">Total Loan Amount</span>
                            <span class="text-xs lg:text-sm font-semibold text-text-primary" id="total-loan">$240,000</span>
                        </div>
                        <div class="flex justify-between items-center p-2.5 lg:p-3 bg-gray-100 rounded-lg border border-gray-200">
                            <span class="text-xs lg:text-sm font-medium text-text-secondary">Total Interest Paid</span>
                            <span class="text-xs lg:text-sm font-semibold text-text-primary" id="total-interest">$407,280</span>
                        </div>
                        <div class="flex justify-between items-center p-2.5 lg:p-3 bg-gray-100 rounded-lg border border-gray-200">
                            <span class="text-xs lg:text-sm font-medium text-text-secondary">Total Cost</span>
                            <span class="text-xs lg:text-sm font-semibold text-text-primary" id="total-cost">$647,280</span>
                        </div>
                    </div>
                </div>

                <div class="bg-gray-100 p-3 lg:p-4 rounded-lg border border-gray-200">
                    <h3 class="text-sm lg:text-base font-semibold text-text-primary mb-2 lg:mb-3 text-center">Payment Breakdown</h3>
                    <div class="h-48 lg:h-64 flex items-center justify-center">
                        <canvas id="payment-chart" class="max-w-full max-h-full"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Amortization Schedule -->
    <div class="bg-white/50 p-4 sm:p-6 rounded-xl border border-gray-200">
        <h3 class="text-lg font-semibold text-text-primary mb-4 lg:mb-6 pb-2 border-b-2 border-primary-500">Amortization Schedule (First 12 Months)</h3>
        <div class="overflow-x-auto rounded-lg border border-gray-200">
            <table id="amortization-table" class="w-full text-xs lg:text-sm bg-white">
                <thead>
                <tr class="bg-gray-100">
                    <th class="px-2 lg:px-4 py-2 lg:py-3 text-center font-semibold text-text-primary whitespace-nowrap">Payment #</th>
                    <th class="px-2 lg:px-4 py-2 lg:py-3 text-left font-semibold text-text-primary whitespace-nowrap">Payment Date</th>
                    <th class="px-2 lg:px-4 py-2 lg:py-3 text-right font-semibold text-text-primary whitespace-nowrap">Payment Amount</th>
                    <th class="px-2 lg:px-4 py-2 lg:py-3 text-right font-semibold text-text-primary whitespace-nowrap">Principal</th>
                    <th class="px-2 lg:px-4 py-2 lg:py-3 text-right font-semibold text-text-primary whitespace-nowrap">Interest</th>
                    <th class="px-2 lg:px-4 py-2 lg:py-3 text-right font-semibold text-text-primary whitespace-nowrap">Remaining Balance</th>
                </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                <!-- Populated by JavaScript -->
                </tbody>
            </table>
        </div>
    </div>
</div>

</html>